<!DOCTYPE html>
<html>
<head>
  <title>Ammu ‚ù§Ô∏è Nani Stars</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      text-align: center;
      font-family: Arial;
      background: linear-gradient(to right, #ff758c, #ff7eb3);
      color: white;
    }
    .box {
      background: rgba(0,0,0,0.3);
      padding: 20px;
      margin: 20px;
      border-radius: 15px;
      display: inline-block;
      width: 250px;
    }
    button {
      padding: 10px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    .add { background: #4CAF50; color: white; }
  </style>
</head>
<body>

<h1>‚≠ê Ammu ‚ù§Ô∏è Nani ‚≠ê</h1>

<div class="box">
  <h2>Ammu</h2>
  <h3 id="ammuStars">0</h3>
  <button class="add" onclick="addStar('Ammu')">Nani Gives Star ‚≠ê</button>
</div>

<div class="box">
  <h2>Nani</h2>
  <h3 id="naniStars">0</h3>
  <button class="add" onclick="addStar('Nani')">Ammu Gives Star ‚≠ê</button>
</div>

<script>
  const supabase = window.supabase.createClient(
    "https://dpnoooewtbjkzxcugkrd.supabase.co",
    "
  );eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRwbm9vb2V3dGJqa3p4Y3Vna3JkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2ODYxODMsImV4cCI6MjA4NzI2MjE4M30.ugDUdtpEArQ38DH3mulCKuDTV4scWtCKtZXkQ-CzFnI"

  async function loadStars() {
    const { data } = await supabase.from("stars").select("*");

    data.forEach(row => {
      if (row.name === "Ammu") {
        document.getElementById("ammuStars").innerText = row.count;
      }
      if (row.name === "Nani") {
        document.getElementById("naniStars").innerText = row.count;
      }
    });
  }

  async function addStar(name) {
    const { data } = await supabase
      .from("stars")
      .select("*")
      .eq("name", name)
      .single();

    let newCount = data.count + 1;

    await supabase
      .from("stars")
      .update({ count: newCount })
      .eq("name", name);

    if (newCount % 50 === 0) {
      alert("üéÅ 50 Stars Reached! Gift Time!");
    }

    loadStars();
  }

  loadStars();

  supabase
    .channel('realtime-stars')
    .on('postgres_changes', { event: '*', schema: 'public', table: 'stars' }, () => {
      loadStars();
    })
    .subscribe();
</script>

</body>
</html>
